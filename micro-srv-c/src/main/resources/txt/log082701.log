2024-08-27 15:48:38[INFO]total:87 sql statements,detail:
DELETE FROM nm_gbase_dw.dw_sum_derive_calculate_m where index_code in ( 'dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M','dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M_restrict2323','dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M_restrict2324','dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M_restrict2325','dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M_restrict2326','dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M_restrict2327','dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M_restrict2328' ) and month_id=202401;
/*skip=true*/ALTER TABLE nm_gbase_dw.dw_sum_derive_calculate_m ADD PARTITION (PARTITION month_id_202401 VALUES IN (202401));
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_48690757_16_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_20268245_18_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_24306206_20_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_78303258_22_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_41405718_38_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_53776475_40_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_53469304_42_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_40884279_44_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_86765467_60_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_45233006_62_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_22662559_64_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_77536047_66_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_89151503_82_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_83758663_84_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_50591660_86_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_60469766_88_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_98963022_104_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_35618992_106_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_42508593_108_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_81605901_110_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_93261887_111_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_54698721_112_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_35417837_113_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_28244470_114_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.tmp_53223846_115_202401;
/*skip=true*/DROP TABLE IF EXISTS nm_gbase_dw.app_1724743201988;
CREATE TABLE nm_gbase_dw.tmp_48690757_16_202401 AS select tb2.MICRO_GRID_ID as consume_area_id,tb2.MICRO_GRID_NAME as consume_area_name,tb2.GRID_ID as consume_parent_area_id,4 as consume_area_level,SUM(tb1.count_grp_num_m_4956) as count_grp_num_m_4956_SUM,SUM(tb1.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb1.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,SUM(tb1.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb1.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,SUM(tb1.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb1.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb1 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb2 on tb1.MICRO_GRID_ID = tb2.MICRO_GRID_ID where ( tb1.month_id =202401 ) group by tb2.MICRO_GRID_ID,tb2.MICRO_GRID_NAME,tb2.GRID_ID;
CREATE TABLE nm_gbase_dw.tmp_20268245_18_202401 AS select tb4.MICRO_GRID_ID as consume_area_id,tb4.MICRO_GRID_NAME as consume_area_name,tb4.GRID_ID as consume_parent_area_id,4 as consume_area_level,0 as count_grp_num_m_4956_SUM,SUM(tb3.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb3.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,0 as count_grp_num_m_4956_yoy,0 as count_grp_num_m_4956_yoyGrowth,0 as count_grp_num_m_4956_yearEnd,0 as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb3 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb4 on tb3.MICRO_GRID_ID = tb4.MICRO_GRID_ID where ( tb3.month_id =202312 ) group by tb4.MICRO_GRID_ID,tb4.MICRO_GRID_NAME,tb4.GRID_ID;
CREATE TABLE nm_gbase_dw.tmp_24306206_20_202401 AS select tb8.MICRO_GRID_ID as consume_area_id,tb8.MICRO_GRID_NAME as consume_area_name,tb8.GRID_ID as consume_parent_area_id,4 as consume_area_level,0 as count_grp_num_m_4956_SUM,0 as count_grp_num_m_4956_pp,0 as count_grp_num_m_4956_momGrowth,SUM(tb7.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb7.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,0 as count_grp_num_m_4956_yearEnd,0 as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb7 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb8 on tb7.MICRO_GRID_ID = tb8.MICRO_GRID_ID where ( tb7.month_id =202301 ) group by tb8.MICRO_GRID_ID,tb8.MICRO_GRID_NAME,tb8.GRID_ID;
CREATE TABLE nm_gbase_dw.tmp_78303258_22_202401 AS select tb12.MICRO_GRID_ID as consume_area_id,tb12.MICRO_GRID_NAME as consume_area_name,tb12.GRID_ID as consume_parent_area_id,4 as consume_area_level,0 as count_grp_num_m_4956_SUM,0 as count_grp_num_m_4956_pp,0 as count_grp_num_m_4956_momGrowth,0 as count_grp_num_m_4956_yoy,0 as count_grp_num_m_4956_yoyGrowth,SUM(tb11.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb11.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb11 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb12 on tb11.MICRO_GRID_ID = tb12.MICRO_GRID_ID where ( tb11.month_id =202312 ) group by tb12.MICRO_GRID_ID,tb12.MICRO_GRID_NAME,tb12.GRID_ID;
CREATE TABLE nm_gbase_dw.tmp_41405718_38_202401 AS select tb24.GRID_ID as consume_area_id,tb24.GRID_NAME as consume_area_name,tb24.BUSN_DEPT_CODE as consume_parent_area_id,3 as consume_area_level,SUM(tb23.count_grp_num_m_4956) as count_grp_num_m_4956_SUM,SUM(tb23.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb23.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,SUM(tb23.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb23.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,SUM(tb23.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb23.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb23 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb24 on tb23.MICRO_GRID_ID = tb24.MICRO_GRID_ID where ( tb23.month_id =202401 ) group by tb24.GRID_ID,tb24.GRID_NAME,tb24.BUSN_DEPT_CODE;
CREATE TABLE nm_gbase_dw.tmp_53776475_40_202401 AS select tb26.GRID_ID as consume_area_id,tb26.GRID_NAME as consume_area_name,tb26.BUSN_DEPT_CODE as consume_parent_area_id,3 as consume_area_level,0 as count_grp_num_m_4956_SUM,SUM(tb25.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb25.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,0 as count_grp_num_m_4956_yoy,0 as count_grp_num_m_4956_yoyGrowth,0 as count_grp_num_m_4956_yearEnd,0 as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb25 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb26 on tb25.MICRO_GRID_ID = tb26.MICRO_GRID_ID where ( tb25.month_id =202312 ) group by tb26.GRID_ID,tb26.GRID_NAME,tb26.BUSN_DEPT_CODE;
CREATE TABLE nm_gbase_dw.tmp_53469304_42_202401 AS select tb30.GRID_ID as consume_area_id,tb30.GRID_NAME as consume_area_name,tb30.BUSN_DEPT_CODE as consume_parent_area_id,3 as consume_area_level,0 as count_grp_num_m_4956_SUM,0 as count_grp_num_m_4956_pp,0 as count_grp_num_m_4956_momGrowth,SUM(tb29.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb29.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,0 as count_grp_num_m_4956_yearEnd,0 as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb29 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb30 on tb29.MICRO_GRID_ID = tb30.MICRO_GRID_ID where ( tb29.month_id =202301 ) group by tb30.GRID_ID,tb30.GRID_NAME,tb30.BUSN_DEPT_CODE;
CREATE TABLE nm_gbase_dw.tmp_40884279_44_202401 AS select tb34.GRID_ID as consume_area_id,tb34.GRID_NAME as consume_area_name,tb34.BUSN_DEPT_CODE as consume_parent_area_id,3 as consume_area_level,0 as count_grp_num_m_4956_SUM,0 as count_grp_num_m_4956_pp,0 as count_grp_num_m_4956_momGrowth,0 as count_grp_num_m_4956_yoy,0 as count_grp_num_m_4956_yoyGrowth,SUM(tb33.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb33.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb33 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb34 on tb33.MICRO_GRID_ID = tb34.MICRO_GRID_ID where ( tb33.month_id =202312 ) group by tb34.GRID_ID,tb34.GRID_NAME,tb34.BUSN_DEPT_CODE;
CREATE TABLE nm_gbase_dw.tmp_86765467_60_202401 AS select tb46.BUSN_DEPT_CODE as consume_area_id,tb46.BUSN_DEPT_NAME as consume_area_name,tb46.CITY_ID as consume_parent_area_id,2 as consume_area_level,SUM(tb45.count_grp_num_m_4956) as count_grp_num_m_4956_SUM,SUM(tb45.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb45.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,SUM(tb45.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb45.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,SUM(tb45.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb45.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb45 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb46 on tb45.MICRO_GRID_ID = tb46.MICRO_GRID_ID where ( tb45.month_id =202401 ) group by tb46.BUSN_DEPT_CODE,tb46.BUSN_DEPT_NAME,tb46.CITY_ID;
CREATE TABLE nm_gbase_dw.tmp_45233006_62_202401 AS select tb48.BUSN_DEPT_CODE as consume_area_id,tb48.BUSN_DEPT_NAME as consume_area_name,tb48.CITY_ID as consume_parent_area_id,2 as consume_area_level,0 as count_grp_num_m_495
2024-08-27 15:48:38[INFO]Start executing SQL ...
2024-08-27 15:48:38[INFO]Database user:nm_gbase_dw,Database Type:gbase
2024-08-27 15:48:40[INFO]
Execute SQL :DELETE FROM nm_gbase_dw.dw_sum_derive_calculate_m where index_code in ( 'dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M','dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M_restrict2323','dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M_restrict2324','dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M_restrict2325','dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M_restrict2326','dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M_restrict2327','dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M_restrict2328' ) and month_id=202401, start time:2024-08-27 15:48:38, end time:2024-08-27 15:48:39, cost:1518, execute success!
2024-08-27 15:48:40[INFO]
Execute SQL :ALTER TABLE nm_gbase_dw.dw_sum_derive_calculate_m ADD PARTITION (PARTITION month_id_202401 VALUES IN (202401)), start time:2024-08-27 15:48:39, end time:2024-08-27 15:48:40, cost:82, execute error but skip:gcluster table error: Duplicate partition name month_id_202401.
2024-08-27 15:48:40[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_48690757_16_202401, start time:2024-08-27 15:48:40, end time:2024-08-27 15:48:40, cost:66, execute success!
2024-08-27 15:48:40[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_20268245_18_202401, start time:2024-08-27 15:48:40, end time:2024-08-27 15:48:40, cost:62, execute success!
2024-08-27 15:48:40[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_24306206_20_202401, start time:2024-08-27 15:48:40, end time:2024-08-27 15:48:40, cost:59, execute success!
2024-08-27 15:48:40[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_78303258_22_202401, start time:2024-08-27 15:48:40, end time:2024-08-27 15:48:40, cost:57, execute success!
2024-08-27 15:48:40[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_41405718_38_202401, start time:2024-08-27 15:48:40, end time:2024-08-27 15:48:40, cost:77, execute success!
2024-08-27 15:48:40[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_53776475_40_202401, start time:2024-08-27 15:48:40, end time:2024-08-27 15:48:40, cost:73, execute success!
2024-08-27 15:48:41[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_53469304_42_202401, start time:2024-08-27 15:48:40, end time:2024-08-27 15:48:40, cost:79, execute success!
2024-08-27 15:48:41[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_40884279_44_202401, start time:2024-08-27 15:48:40, end time:2024-08-27 15:48:40, cost:64, execute success!
2024-08-27 15:48:41[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_86765467_60_202401, start time:2024-08-27 15:48:40, end time:2024-08-27 15:48:40, cost:77, execute success!
2024-08-27 15:48:41[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_45233006_62_202401, start time:2024-08-27 15:48:40, end time:2024-08-27 15:48:40, cost:64, execute success!
2024-08-27 15:48:41[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_22662559_64_202401, start time:2024-08-27 15:48:40, end time:2024-08-27 15:48:40, cost:79, execute success!
2024-08-27 15:48:41[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_77536047_66_202401, start time:2024-08-27 15:48:40, end time:2024-08-27 15:48:40, cost:62, execute success!
2024-08-27 15:48:41[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_89151503_82_202401, start time:2024-08-27 15:48:40, end time:2024-08-27 15:48:40, cost:69, execute success!
2024-08-27 15:48:41[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_83758663_84_202401, start time:2024-08-27 15:48:40, end time:2024-08-27 15:48:41, cost:59, execute success!
2024-08-27 15:48:41[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_50591660_86_202401, start time:2024-08-27 15:48:41, end time:2024-08-27 15:48:41, cost:242, execute success!
2024-08-27 15:48:41[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_60469766_88_202401, start time:2024-08-27 15:48:41, end time:2024-08-27 15:48:41, cost:67, execute success!
2024-08-27 15:48:42[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_98963022_104_202401, start time:2024-08-27 15:48:41, end time:2024-08-27 15:48:41, cost:190, execute success!
2024-08-27 15:48:42[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_35618992_106_202401, start time:2024-08-27 15:48:41, end time:2024-08-27 15:48:41, cost:66, execute success!
2024-08-27 15:48:42[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_42508593_108_202401, start time:2024-08-27 15:48:41, end time:2024-08-27 15:48:41, cost:67, execute success!
2024-08-27 15:48:42[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_81605901_110_202401, start time:2024-08-27 15:48:41, end time:2024-08-27 15:48:41, cost:55, execute success!
2024-08-27 15:48:42[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_93261887_111_202401, start time:2024-08-27 15:48:41, end time:2024-08-27 15:48:41, cost:70, execute success!
2024-08-27 15:48:42[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_54698721_112_202401, start time:2024-08-27 15:48:41, end time:2024-08-27 15:48:41, cost:59, execute success!
2024-08-27 15:48:42[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_35417837_113_202401, start time:2024-08-27 15:48:41, end time:2024-08-27 15:48:41, cost:68, execute success!
2024-08-27 15:48:42[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_28244470_114_202401, start time:2024-08-27 15:48:41, end time:2024-08-27 15:48:42, cost:61, execute success!
2024-08-27 15:48:42[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.tmp_53223846_115_202401, start time:2024-08-27 15:48:42, end time:2024-08-27 15:48:42, cost:213, execute success!
2024-08-27 15:48:42[INFO]
Execute SQL :DROP TABLE IF EXISTS nm_gbase_dw.app_1724743201988, start time:2024-08-27 15:48:42, end time:2024-08-27 15:48:42, cost:57, execute success!
2024-08-27 15:48:47[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_48690757_16_202401 AS select tb2.MICRO_GRID_ID as consume_area_id,tb2.MICRO_GRID_NAME as consume_area_name,tb2.GRID_ID as consume_parent_area_id,4 as consume_area_level,SUM(tb1.count_grp_num_m_4956) as count_grp_num_m_4956_SUM,SUM(tb1.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb1.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,SUM(tb1.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb1.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,SUM(tb1.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb1.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb1 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb2 on tb1.MICRO_GRID_ID = tb2.MICRO_GRID_ID where ( tb1.month_id =202401 ) group by tb2.MICRO_GRID_ID,tb2.MICRO_GRID_NAME,tb2.GRID_ID, start time:2024-08-27 15:48:42, end time:2024-08-27 15:48:46, cost:4579, execute success!
2024-08-27 15:48:47[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_20268245_18_202401 AS select tb4.MICRO_GRID_ID as consume_area_id,tb4.MICRO_GRID_NAME as consume_area_name,tb4.GRID_ID as consume_parent_area_id,4 as consume_area_level,0 as count_grp_num_m_4956_SUM,SUM(tb3.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb3.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,0 as count_grp_num_m_4956_yoy,0 as count_grp_num_m_4956_yoyGrowth,0 as count_grp_num_m_4956_yearEnd,0 as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb3 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb4 on tb3.MICRO_GRID_ID = tb4.MICRO_GRID_ID where ( tb3.month_id =202312 ) group by tb4.MICRO_GRID_ID,tb4.MICRO_GRID_NAME,tb4.GRID_ID, start time:2024-08-27 15:48:46, end time:2024-08-27 15:48:47, cost:512, execute success!
2024-08-27 15:48:48[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_24306206_20_202401 AS select tb8.MICRO_GRID_ID as consume_area_id,tb8.MICRO_GRID_NAME as consume_area_name,tb8.GRID_ID as consume_parent_area_id,4 as consume_area_level,0 as count_grp_num_m_4956_SUM,0 as count_grp_num_m_4956_pp,0 as count_grp_num_m_4956_momGrowth,SUM(tb7.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb7.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,0 as count_grp_num_m_4956_yearEnd,0 as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb7 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb8 on tb7.MICRO_GRID_ID = tb8.MICRO_GRID_ID where ( tb7.month_id =202301 ) group by tb8.MICRO_GRID_ID,tb8.MICRO_GRID_NAME,tb8.GRID_ID, start time:2024-08-27 15:48:47, end time:2024-08-27 15:48:47, cost:406, execute success!
2024-08-27 15:48:48[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_78303258_22_202401 AS select tb12.MICRO_GRID_ID as consume_area_id,tb12.MICRO_GRID_NAME as consume_area_name,tb12.GRID_ID as consume_parent_area_id,4 as consume_area_level,0 as count_grp_num_m_4956_SUM,0 as count_grp_num_m_4956_pp,0 as count_grp_num_m_4956_momGrowth,0 as count_grp_num_m_4956_yoy,0 as count_grp_num_m_4956_yoyGrowth,SUM(tb11.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb11.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb11 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb12 on tb11.MICRO_GRID_ID = tb12.MICRO_GRID_ID where ( tb11.month_id =202312 ) group by tb12.MICRO_GRID_ID,tb12.MICRO_GRID_NAME,tb12.GRID_ID, start time:2024-08-27 15:48:47, end time:2024-08-27 15:48:48, cost:478, execute success!
2024-08-27 15:48:53[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_41405718_38_202401 AS select tb24.GRID_ID as consume_area_id,tb24.GRID_NAME as consume_area_name,tb24.BUSN_DEPT_CODE as consume_parent_area_id,3 as consume_area_level,SUM(tb23.count_grp_num_m_4956) as count_grp_num_m_4956_SUM,SUM(tb23.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb23.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,SUM(tb23.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb23.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,SUM(tb23.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb23.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb23 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb24 on tb23.MICRO_GRID_ID = tb24.MICRO_GRID_ID where ( tb23.month_id =202401 ) group by tb24.GRID_ID,tb24.GRID_NAME,tb24.BUSN_DEPT_CODE, start time:2024-08-27 15:48:48, end time:2024-08-27 15:48:52, cost:4226, execute success!
2024-08-27 15:48:53[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_53776475_40_202401 AS select tb26.GRID_ID as consume_area_id,tb26.GRID_NAME as consume_area_name,tb26.BUSN_DEPT_CODE as consume_parent_area_id,3 as consume_area_level,0 as count_grp_num_m_4956_SUM,SUM(tb25.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb25.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,0 as count_grp_num_m_4956_yoy,0 as count_grp_num_m_4956_yoyGrowth,0 as count_grp_num_m_4956_yearEnd,0 as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb25 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb26 on tb25.MICRO_GRID_ID = tb26.MICRO_GRID_ID where ( tb25.month_id =202312 ) group by tb26.GRID_ID,tb26.GRID_NAME,tb26.BUSN_DEPT_CODE, start time:2024-08-27 15:48:52, end time:2024-08-27 15:48:53, cost:576, execute success!
2024-08-27 15:48:54[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_53469304_42_202401 AS select tb30.GRID_ID as consume_area_id,tb30.GRID_NAME as consume_area_name,tb30.BUSN_DEPT_CODE as consume_parent_area_id,3 as consume_area_level,0 as count_grp_num_m_4956_SUM,0 as count_grp_num_m_4956_pp,0 as count_grp_num_m_4956_momGrowth,SUM(tb29.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb29.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,0 as count_grp_num_m_4956_yearEnd,0 as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb29 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb30 on tb29.MICRO_GRID_ID = tb30.MICRO_GRID_ID where ( tb29.month_id =202301 ) group by tb30.GRID_ID,tb30.GRID_NAME,tb30.BUSN_DEPT_CODE, start time:2024-08-27 15:48:53, end time:2024-08-27 15:48:53, cost:518, execute success!
2024-08-27 15:48:54[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_40884279_44_202401 AS select tb34.GRID_ID as consume_area_id,tb34.GRID_NAME as consume_area_name,tb34.BUSN_DEPT_CODE as consume_parent_area_id,3 as consume_area_level,0 as count_grp_num_m_4956_SUM,0 as count_grp_num_m_4956_pp,0 as count_grp_num_m_4956_momGrowth,0 as count_grp_num_m_4956_yoy,0 as count_grp_num_m_4956_yoyGrowth,SUM(tb33.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb33.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb33 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb34 on tb33.MICRO_GRID_ID = tb34.MICRO_GRID_ID where ( tb33.month_id =202312 ) group by tb34.GRID_ID,tb34.GRID_NAME,tb34.BUSN_DEPT_CODE, start time:2024-08-27 15:48:53, end time:2024-08-27 15:48:54, cost:448, execute success!
2024-08-27 15:48:58[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_86765467_60_202401 AS select tb46.BUSN_DEPT_CODE as consume_area_id,tb46.BUSN_DEPT_NAME as consume_area_name,tb46.CITY_ID as consume_parent_area_id,2 as consume_area_level,SUM(tb45.count_grp_num_m_4956) as count_grp_num_m_4956_SUM,SUM(tb45.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb45.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,SUM(tb45.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb45.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,SUM(tb45.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb45.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb45 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb46 on tb45.MICRO_GRID_ID = tb46.MICRO_GRID_ID where ( tb45.month_id =202401 ) group by tb46.BUSN_DEPT_CODE,tb46.BUSN_DEPT_NAME,tb46.CITY_ID, start time:2024-08-27 15:48:54, end time:2024-08-27 15:48:58, cost:4065, execute success!
2024-08-27 15:48:59[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_45233006_62_202401 AS select tb48.BUSN_DEPT_CODE as consume_area_id,tb48.BUSN_DEPT_NAME as consume_area_name,tb48.CITY_ID as consume_parent_area_id,2 as consume_area_level,0 as count_grp_num_m_4956_SUM,SUM(tb47.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb47.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,0 as count_grp_num_m_4956_yoy,0 as count_grp_num_m_4956_yoyGrowth,0 as count_grp_num_m_4956_yearEnd,0 as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb47 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb48 on tb47.MICRO_GRID_ID = tb48.MICRO_GRID_ID where ( tb47.month_id =202312 ) group by tb48.BUSN_DEPT_CODE,tb48.BUSN_DEPT_NAME,tb48.CITY_ID, start time:2024-08-27 15:48:58, end time:2024-08-27 15:48:58, cost:515, execute success!
2024-08-27 15:48:59[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_22662559_64_202401 AS select tb52.BUSN_DEPT_CODE as consume_area_id,tb52.BUSN_DEPT_NAME as consume_area_name,tb52.CITY_ID as consume_parent_area_id,2 as consume_area_level,0 as count_grp_num_m_4956_SUM,0 as count_grp_num_m_4956_pp,0 as count_grp_num_m_4956_momGrowth,SUM(tb51.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb51.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,0 as count_grp_num_m_4956_yearEnd,0 as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb51 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb52 on tb51.MICRO_GRID_ID = tb52.MICRO_GRID_ID where ( tb51.month_id =202301 ) group by tb52.BUSN_DEPT_CODE,tb52.BUSN_DEPT_NAME,tb52.CITY_ID, start time:2024-08-27 15:48:58, end time:2024-08-27 15:48:59, cost:464, execute success!
2024-08-27 15:49:00[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_77536047_66_202401 AS select tb56.BUSN_DEPT_CODE as consume_area_id,tb56.BUSN_DEPT_NAME as consume_area_name,tb56.CITY_ID as consume_parent_area_id,2 as consume_area_level,0 as count_grp_num_m_4956_SUM,0 as count_grp_num_m_4956_pp,0 as count_grp_num_m_4956_momGrowth,0 as count_grp_num_m_4956_yoy,0 as count_grp_num_m_4956_yoyGrowth,SUM(tb55.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb55.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb55 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb56 on tb55.MICRO_GRID_ID = tb56.MICRO_GRID_ID where ( tb55.month_id =202312 ) group by tb56.BUSN_DEPT_CODE,tb56.BUSN_DEPT_NAME,tb56.CITY_ID, start time:2024-08-27 15:48:59, end time:2024-08-27 15:48:59, cost:455, execute success!
2024-08-27 15:49:03[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_89151503_82_202401 AS select tb68.CITY_ID as consume_area_id,tb68.CITY_NAME as consume_area_name,tb68.PROV_ID as consume_parent_area_id,1 as consume_area_level,SUM(tb67.count_grp_num_m_4956) as count_grp_num_m_4956_SUM,SUM(tb67.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb67.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,SUM(tb67.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb67.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,SUM(tb67.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb67.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb67 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb68 on tb67.MICRO_GRID_ID = tb68.MICRO_GRID_ID where ( tb67.month_id =202401 ) group by tb68.CITY_ID,tb68.CITY_NAME,tb68.PROV_ID, start time:2024-08-27 15:48:59, end time:2024-08-27 15:49:03, cost:3715, execute success!
2024-08-27 15:49:04[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_83758663_84_202401 AS select tb70.CITY_ID as consume_area_id,tb70.CITY_NAME as consume_area_name,tb70.PROV_ID as consume_parent_area_id,1 as consume_area_level,0 as count_grp_num_m_4956_SUM,SUM(tb69.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb69.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,0 as count_grp_num_m_4956_yoy,0 as count_grp_num_m_4956_yoyGrowth,0 as count_grp_num_m_4956_yearEnd,0 as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb69 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb70 on tb69.MICRO_GRID_ID = tb70.MICRO_GRID_ID where ( tb69.month_id =202312 ) group by tb70.CITY_ID,tb70.CITY_NAME,tb70.PROV_ID, start time:2024-08-27 15:49:03, end time:2024-08-27 15:49:03, cost:470, execute success!
2024-08-27 15:49:04[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_50591660_86_202401 AS select tb74.CITY_ID as consume_area_id,tb74.CITY_NAME as consume_area_name,tb74.PROV_ID as consume_parent_area_id,1 as consume_area_level,0 as count_grp_num_m_4956_SUM,0 as count_grp_num_m_4956_pp,0 as count_grp_num_m_4956_momGrowth,SUM(tb73.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb73.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,0 as count_grp_num_m_4956_yearEnd,0 as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb73 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb74 on tb73.MICRO_GRID_ID = tb74.MICRO_GRID_ID where ( tb73.month_id =202301 ) group by tb74.CITY_ID,tb74.CITY_NAME,tb74.PROV_ID, start time:2024-08-27 15:49:03, end time:2024-08-27 15:49:04, cost:458, execute success!
2024-08-27 15:49:05[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_60469766_88_202401 AS select tb78.CITY_ID as consume_area_id,tb78.CITY_NAME as consume_area_name,tb78.PROV_ID as consume_parent_area_id,1 as consume_area_level,0 as count_grp_num_m_4956_SUM,0 as count_grp_num_m_4956_pp,0 as count_grp_num_m_4956_momGrowth,0 as count_grp_num_m_4956_yoy,0 as count_grp_num_m_4956_yoyGrowth,SUM(tb77.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb77.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb77 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb78 on tb77.MICRO_GRID_ID = tb78.MICRO_GRID_ID where ( tb77.month_id =202312 ) group by tb78.CITY_ID,tb78.CITY_NAME,tb78.PROV_ID, start time:2024-08-27 15:49:04, end time:2024-08-27 15:49:04, cost:491, execute success!
2024-08-27 15:49:09[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_98963022_104_202401 AS select tb90.PROV_ID as consume_area_id,tb90.PROV_NAME as consume_area_name,null as consume_parent_area_id,0 as consume_area_level,SUM(tb89.count_grp_num_m_4956) as count_grp_num_m_4956_SUM,SUM(tb89.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb89.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,SUM(tb89.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb89.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,SUM(tb89.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb89.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb89 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb90 on tb89.MICRO_GRID_ID = tb90.MICRO_GRID_ID where ( tb89.month_id =202401 ) group by tb90.PROV_ID,tb90.PROV_NAME, start time:2024-08-27 15:49:04, end time:2024-08-27 15:49:09, cost:4391, execute success!
2024-08-27 15:49:10[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_35618992_106_202401 AS select tb92.PROV_ID as consume_area_id,tb92.PROV_NAME as consume_area_name,null as consume_parent_area_id,0 as consume_area_level,0 as count_grp_num_m_4956_SUM,SUM(tb91.count_grp_num_m_4956) as count_grp_num_m_4956_pp,SUM(tb91.count_grp_num_m_4956) as count_grp_num_m_4956_momGrowth,0 as count_grp_num_m_4956_yoy,0 as count_grp_num_m_4956_yoyGrowth,0 as count_grp_num_m_4956_yearEnd,0 as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb91 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb92 on tb91.MICRO_GRID_ID = tb92.MICRO_GRID_ID where ( tb91.month_id =202312 ) group by tb92.PROV_ID,tb92.PROV_NAME, start time:2024-08-27 15:49:09, end time:2024-08-27 15:49:09, cost:421, execute success!
2024-08-27 15:49:10[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_42508593_108_202401 AS select tb96.PROV_ID as consume_area_id,tb96.PROV_NAME as consume_area_name,null as consume_parent_area_id,0 as consume_area_level,0 as count_grp_num_m_4956_SUM,0 as count_grp_num_m_4956_pp,0 as count_grp_num_m_4956_momGrowth,SUM(tb95.count_grp_num_m_4956) as count_grp_num_m_4956_yoy,SUM(tb95.count_grp_num_m_4956) as count_grp_num_m_4956_yoyGrowth,0 as count_grp_num_m_4956_yearEnd,0 as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb95 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb96 on tb95.MICRO_GRID_ID = tb96.MICRO_GRID_ID where ( tb95.month_id =202301 ) group by tb96.PROV_ID,tb96.PROV_NAME, start time:2024-08-27 15:49:09, end time:2024-08-27 15:49:10, cost:414, execute success!
2024-08-27 15:49:11[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_81605901_110_202401 AS select tb100.PROV_ID as consume_area_id,tb100.PROV_NAME as consume_area_name,null as consume_parent_area_id,0 as consume_area_level,0 as count_grp_num_m_4956_SUM,0 as count_grp_num_m_4956_pp,0 as count_grp_num_m_4956_momGrowth,0 as count_grp_num_m_4956_yoy,0 as count_grp_num_m_4956_yoyGrowth,SUM(tb99.count_grp_num_m_4956) as count_grp_num_m_4956_yearEnd,SUM(tb99.count_grp_num_m_4956) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.DW_SUM_DERIVE_GRP_MICROGRID_M_001 tb99 inner join nm_gbase_dw.dw_smart_microgrid_grid_info tb100 on tb99.MICRO_GRID_ID = tb100.MICRO_GRID_ID where ( tb99.month_id =202312 ) group by tb100.PROV_ID,tb100.PROV_NAME, start time:2024-08-27 15:49:10, end time:2024-08-27 15:49:10, cost:589, execute success!
2024-08-27 15:49:13[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_93261887_111_202401 AS select tb15.consume_area_id,tb15.consume_area_name,tb15.consume_parent_area_id,tb15.consume_area_level,tb15.count_grp_num_m_4956_SUM as count_grp_num_m_4956_SUM,IFNULL( ( tb15.count_grp_num_m_4956_pp-tb17.count_grp_num_m_4956_pp ) ,0) as count_grp_num_m_4956_pp,IFNULL((case when tb17.count_grp_num_m_4956_momGrowth = 0 then 0 else ( tb15.count_grp_num_m_4956_momGrowth-tb17.count_grp_num_m_4956_momGrowth ) /tb17.count_grp_num_m_4956_momGrowth end),0) as count_grp_num_m_4956_momGrowth,IFNULL( ( tb15.count_grp_num_m_4956_yoy-tb19.count_grp_num_m_4956_yoy ) ,0) as count_grp_num_m_4956_yoy,IFNULL((case when tb19.count_grp_num_m_4956_yoyGrowth = 0 then 0 else ( tb15.count_grp_num_m_4956_yoyGrowth-tb19.count_grp_num_m_4956_yoyGrowth ) /tb19.count_grp_num_m_4956_yoyGrowth end),0) as count_grp_num_m_4956_yoyGrowth,IFNULL( ( tb15.count_grp_num_m_4956_yearEnd-tb21.count_grp_num_m_4956_yearEnd ) ,0) as count_grp_num_m_4956_yearEnd,IFNULL((case when tb21.count_grp_num_m_4956_yearEndGrowth = 0 then 0 else ( tb15.count_grp_num_m_4956_yearEndGrowth-tb21.count_grp_num_m_4956_yearEndGrowth ) /tb21.count_grp_num_m_4956_yearEndGrowth end),0) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.tmp_48690757_16_202401 tb15 left join nm_gbase_dw.tmp_20268245_18_202401 tb17 on tb15.consume_area_id = tb17.consume_area_id and tb15.consume_area_name = tb17.consume_area_name left join nm_gbase_dw.tmp_24306206_20_202401 tb19 on tb15.consume_area_id = tb19.consume_area_id and tb15.consume_area_name = tb19.consume_area_name left join nm_gbase_dw.tmp_78303258_22_202401 tb21 on tb15.consume_area_id = tb21.consume_area_id and tb15.consume_area_name = tb21.consume_area_name, start time:2024-08-27 15:49:10, end time:2024-08-27 15:49:13, cost:2367, execute success!
2024-08-27 15:49:15[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_54698721_112_202401 AS select tb37.consume_area_id,tb37.consume_area_name,tb37.consume_parent_area_id,tb37.consume_area_level,tb37.count_grp_num_m_4956_SUM as count_grp_num_m_4956_SUM,IFNULL( ( tb37.count_grp_num_m_4956_pp-tb39.count_grp_num_m_4956_pp ) ,0) as count_grp_num_m_4956_pp,IFNULL((case when tb39.count_grp_num_m_4956_momGrowth = 0 then 0 else ( tb37.count_grp_num_m_4956_momGrowth-tb39.count_grp_num_m_4956_momGrowth ) /tb39.count_grp_num_m_4956_momGrowth end),0) as count_grp_num_m_4956_momGrowth,IFNULL( ( tb37.count_grp_num_m_4956_yoy-tb41.count_grp_num_m_4956_yoy ) ,0) as count_grp_num_m_4956_yoy,IFNULL((case when tb41.count_grp_num_m_4956_yoyGrowth = 0 then 0 else ( tb37.count_grp_num_m_4956_yoyGrowth-tb41.count_grp_num_m_4956_yoyGrowth ) /tb41.count_grp_num_m_4956_yoyGrowth end),0) as count_grp_num_m_4956_yoyGrowth,IFNULL( ( tb37.count_grp_num_m_4956_yearEnd-tb43.count_grp_num_m_4956_yearEnd ) ,0) as count_grp_num_m_4956_yearEnd,IFNULL((case when tb43.count_grp_num_m_4956_yearEndGrowth = 0 then 0 else ( tb37.count_grp_num_m_4956_yearEndGrowth-tb43.count_grp_num_m_4956_yearEndGrowth ) /tb43.count_grp_num_m_4956_yearEndGrowth end),0) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.tmp_41405718_38_202401 tb37 left join nm_gbase_dw.tmp_53776475_40_202401 tb39 on tb37.consume_area_id = tb39.consume_area_id and tb37.consume_area_name = tb39.consume_area_name left join nm_gbase_dw.tmp_53469304_42_202401 tb41 on tb37.consume_area_id = tb41.consume_area_id and tb37.consume_area_name = tb41.consume_area_name left join nm_gbase_dw.tmp_40884279_44_202401 tb43 on tb37.consume_area_id = tb43.consume_area_id and tb37.consume_area_name = tb43.consume_area_name, start time:2024-08-27 15:49:13, end time:2024-08-27 15:49:15, cost:2230, execute success!
2024-08-27 15:49:18[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_35417837_113_202401 AS select tb59.consume_area_id,tb59.consume_area_name,tb59.consume_parent_area_id,tb59.consume_area_level,tb59.count_grp_num_m_4956_SUM as count_grp_num_m_4956_SUM,IFNULL( ( tb59.count_grp_num_m_4956_pp-tb61.count_grp_num_m_4956_pp ) ,0) as count_grp_num_m_4956_pp,IFNULL((case when tb61.count_grp_num_m_4956_momGrowth = 0 then 0 else ( tb59.count_grp_num_m_4956_momGrowth-tb61.count_grp_num_m_4956_momGrowth ) /tb61.count_grp_num_m_4956_momGrowth end),0) as count_grp_num_m_4956_momGrowth,IFNULL( ( tb59.count_grp_num_m_4956_yoy-tb63.count_grp_num_m_4956_yoy ) ,0) as count_grp_num_m_4956_yoy,IFNULL((case when tb63.count_grp_num_m_4956_yoyGrowth = 0 then 0 else ( tb59.count_grp_num_m_4956_yoyGrowth-tb63.count_grp_num_m_4956_yoyGrowth ) /tb63.count_grp_num_m_4956_yoyGrowth end),0) as count_grp_num_m_4956_yoyGrowth,IFNULL( ( tb59.count_grp_num_m_4956_yearEnd-tb65.count_grp_num_m_4956_yearEnd ) ,0) as count_grp_num_m_4956_yearEnd,IFNULL((case when tb65.count_grp_num_m_4956_yearEndGrowth = 0 then 0 else ( tb59.count_grp_num_m_4956_yearEndGrowth-tb65.count_grp_num_m_4956_yearEndGrowth ) /tb65.count_grp_num_m_4956_yearEndGrowth end),0) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.tmp_86765467_60_202401 tb59 left join nm_gbase_dw.tmp_45233006_62_202401 tb61 on tb59.consume_area_id = tb61.consume_area_id and tb59.consume_area_name = tb61.consume_area_name left join nm_gbase_dw.tmp_22662559_64_202401 tb63 on tb59.consume_area_id = tb63.consume_area_id and tb59.consume_area_name = tb63.consume_area_name left join nm_gbase_dw.tmp_77536047_66_202401 tb65 on tb59.consume_area_id = tb65.consume_area_id and tb59.consume_area_name = tb65.consume_area_name, start time:2024-08-27 15:49:15, end time:2024-08-27 15:49:17, cost:2408, execute success!
2024-08-27 15:49:20[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_28244470_114_202401 AS select tb81.consume_area_id,tb81.consume_area_name,tb81.consume_parent_area_id,tb81.consume_area_level,tb81.count_grp_num_m_4956_SUM as count_grp_num_m_4956_SUM,IFNULL( ( tb81.count_grp_num_m_4956_pp-tb83.count_grp_num_m_4956_pp ) ,0) as count_grp_num_m_4956_pp,IFNULL((case when tb83.count_grp_num_m_4956_momGrowth = 0 then 0 else ( tb81.count_grp_num_m_4956_momGrowth-tb83.count_grp_num_m_4956_momGrowth ) /tb83.count_grp_num_m_4956_momGrowth end),0) as count_grp_num_m_4956_momGrowth,IFNULL( ( tb81.count_grp_num_m_4956_yoy-tb85.count_grp_num_m_4956_yoy ) ,0) as count_grp_num_m_4956_yoy,IFNULL((case when tb85.count_grp_num_m_4956_yoyGrowth = 0 then 0 else ( tb81.count_grp_num_m_4956_yoyGrowth-tb85.count_grp_num_m_4956_yoyGrowth ) /tb85.count_grp_num_m_4956_yoyGrowth end),0) as count_grp_num_m_4956_yoyGrowth,IFNULL( ( tb81.count_grp_num_m_4956_yearEnd-tb87.count_grp_num_m_4956_yearEnd ) ,0) as count_grp_num_m_4956_yearEnd,IFNULL((case when tb87.count_grp_num_m_4956_yearEndGrowth = 0 then 0 else ( tb81.count_grp_num_m_4956_yearEndGrowth-tb87.count_grp_num_m_4956_yearEndGrowth ) /tb87.count_grp_num_m_4956_yearEndGrowth end),0) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.tmp_89151503_82_202401 tb81 left join nm_gbase_dw.tmp_83758663_84_202401 tb83 on tb81.consume_area_id = tb83.consume_area_id and tb81.consume_area_name = tb83.consume_area_name left join nm_gbase_dw.tmp_50591660_86_202401 tb85 on tb81.consume_area_id = tb85.consume_area_id and tb81.consume_area_name = tb85.consume_area_name left join nm_gbase_dw.tmp_60469766_88_202401 tb87 on tb81.consume_area_id = tb87.consume_area_id and tb81.consume_area_name = tb87.consume_area_name, start time:2024-08-27 15:49:17, end time:2024-08-27 15:49:19, cost:2121, execute success!
2024-08-27 15:49:22[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.tmp_53223846_115_202401 AS select tb103.consume_area_id,tb103.consume_area_name,tb103.consume_parent_area_id,tb103.consume_area_level,tb103.count_grp_num_m_4956_SUM as count_grp_num_m_4956_SUM,IFNULL( ( tb103.count_grp_num_m_4956_pp-tb105.count_grp_num_m_4956_pp ) ,0) as count_grp_num_m_4956_pp,IFNULL((case when tb105.count_grp_num_m_4956_momGrowth = 0 then 0 else ( tb103.count_grp_num_m_4956_momGrowth-tb105.count_grp_num_m_4956_momGrowth ) /tb105.count_grp_num_m_4956_momGrowth end),0) as count_grp_num_m_4956_momGrowth,IFNULL( ( tb103.count_grp_num_m_4956_yoy-tb107.count_grp_num_m_4956_yoy ) ,0) as count_grp_num_m_4956_yoy,IFNULL((case when tb107.count_grp_num_m_4956_yoyGrowth = 0 then 0 else ( tb103.count_grp_num_m_4956_yoyGrowth-tb107.count_grp_num_m_4956_yoyGrowth ) /tb107.count_grp_num_m_4956_yoyGrowth end),0) as count_grp_num_m_4956_yoyGrowth,IFNULL( ( tb103.count_grp_num_m_4956_yearEnd-tb109.count_grp_num_m_4956_yearEnd ) ,0) as count_grp_num_m_4956_yearEnd,IFNULL((case when tb109.count_grp_num_m_4956_yearEndGrowth = 0 then 0 else ( tb103.count_grp_num_m_4956_yearEndGrowth-tb109.count_grp_num_m_4956_yearEndGrowth ) /tb109.count_grp_num_m_4956_yearEndGrowth end),0) as count_grp_num_m_4956_yearEndGrowth from nm_gbase_dw.tmp_98963022_104_202401 tb103 left join nm_gbase_dw.tmp_35618992_106_202401 tb105 on tb103.consume_area_id = tb105.consume_area_id and tb103.consume_area_name = tb105.consume_area_name left join nm_gbase_dw.tmp_42508593_108_202401 tb107 on tb103.consume_area_id = tb107.consume_area_id and tb103.consume_area_name = tb107.consume_area_name left join nm_gbase_dw.tmp_81605901_110_202401 tb109 on tb103.consume_area_id = tb109.consume_area_id and tb103.consume_area_name = tb109.consume_area_name, start time:2024-08-27 15:49:19, end time:2024-08-27 15:49:21, cost:2040, execute success!
2024-08-27 15:49:26[INFO]
Execute SQL :CREATE TABLE nm_gbase_dw.app_1724743201988 AS select 202401 as month_id,t1.consume_area_id as consume_area_id/**微网格标识*/,t1.consume_area_name as consume_area_name/**微网格名称*/,t1.consume_parent_area_id as consume_parent_area_id/**微网格名称*/,t1.consume_area_level as consume_area_level,SUM(t1.count_grp_num_m_4956_SUM) as count_grp_num_m_4956_SUM/**集团客户数_月(微格)*/,SUM(t1.count_grp_num_m_4956_pp) as count_grp_num_m_4956_pp/**集团客户数_月(微格)*/,SUM(t1.count_grp_num_m_4956_momGrowth) as count_grp_num_m_4956_momGrowth/**集团客户数_月(微格)*/,SUM(t1.count_grp_num_m_4956_yoy) as count_grp_num_m_4956_yoy/**集团客户数_月(微格)*/,SUM(t1.count_grp_num_m_4956_yoyGrowth) as count_grp_num_m_4956_yoyGrowth/**集团客户数_月(微格)*/,SUM(t1.count_grp_num_m_4956_yearEnd) as count_grp_num_m_4956_yearEnd/**集团客户数_月(微格)*/,SUM(t1.count_grp_num_m_4956_yearEndGrowth) as count_grp_num_m_4956_yearEndGrowth/**集团客户数_月(微格)*/ from ( select * from nm_gbase_dw.tmp_93261887_111_202401 union all select * from nm_gbase_dw.tmp_54698721_112_202401 union all select * from nm_gbase_dw.tmp_35417837_113_202401 union all select * from nm_gbase_dw.tmp_28244470_114_202401 union all select * from nm_gbase_dw.tmp_53223846_115_202401 ) t1 group by t1.consume_area_id,t1.consume_area_name,t1.consume_parent_area_id,t1.consume_area_level, start time:2024-08-27 15:49:21, end time:2024-08-27 15:49:25, cost:4131, execute success!
2024-08-27 15:49:30[INFO]
Execute SQL :INSERT INTO nm_gbase_dw.dw_sum_derive_calculate_m (month_id, dimension_type, dimension_id, dimension_name, parent_dimension_id, dimension_level, index_code, index_value, index_value_pp, index_value_momgrowth, index_value_yoy, index_value_yoygrowth, index_value_yearend, index_value_yearendgrowth) select 202401 as month_id,'dw_smart_microgrid_grid_info' as dimension_type,consume_area_id as dimension_id,consume_area_name as dimension_name,consume_parent_area_id as parent_dimension_id,consume_area_level as dimension_level,'dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M' as index_code,count_grp_num_m_4956_sum as index_value,count_grp_num_m_4956_pp as index_value_pp,count_grp_num_m_4956_momgrowth*100 as index_value_momgrowth,count_grp_num_m_4956_yoy as index_value_yoy,count_grp_num_m_4956_yoygrowth*100 as index_value_yoygrowth,count_grp_num_m_4956_yearend as index_value_yearend,count_grp_num_m_4956_yearendgrowth*100 as index_value_yearendgrowth from nm_gbase_dw.app_1724743201988, start time:2024-08-27 15:49:25, end time:2024-08-27 15:49:29, cost:3654, execute success!
2024-08-27 15:49:30[INFO]
Execute SQL :INSERT INTO nm_gbase_dw.dw_sum_derive_calculate_m (month_id, dimension_type, dimension_id, dimension_name, parent_dimension_id, dimension_level, index_code, index_value, index_value_pp, index_value_momgrowth, index_value_yoy, index_value_yoygrowth, index_value_yearend, index_value_yearendgrowth) select 202401 as month_id,'dw_smart_microgrid_grid_info' as dimension_type,consume_area_id as dimension_id,consume_area_name as dimension_name,consume_parent_area_id as parent_dimension_id,consume_area_level as dimension_level,'dw_smart_microgrid_grid_info_last1Months_COUNT_GRP_NUM_M_restrict2323' as index_code,count_grp_num_m_4975_sum as index_value,count_grp_num_m_4975_pp as index_value_pp,count_grp_num_m_4975_momgrowth*100 as index_value_momgrowth,count_grp_num_m_4975_yoy as index_value_yoy,count_grp_num_m_4975_yoygrowth*100 as index_value_yoygrowth,count_grp_num_m_4975_yearend as index_value_yearend,count_grp_num_m_4975_yearendgrowth*100 as index_value_yearendgrowth from nm_gbase_dw.app_1724743201988, start time:2024-08-27 15:49:29, end time:2024-08-27 15:49:29, cost:14
com.ztesoft.common.exception.SyDevOpsRuntimeException: Unknown column 'count_grp_num_m_4975_sum' in 'field list' at com.ztesoft.dataintegration.workflow.AgentMachine.work(AgentMachine.java:101) at com.ztesoft.dataintegration.workflow.AgentMachine.work(AgentMachine.java:61) at com.ztesoft.dataintegration.scheduler.AgentScheduler$AgentThread.run(AgentScheduler.java:634) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at java.lang.Thread.run(Thread.java:748) Caused by: com.ztesoft.common.exception.SyDevOpsRuntimeException: Unknown column 'count_grp_num_m_4975_sum' in 'field list' at com.ztesoft.dataintegration.invoker.component.sql.SqlInvoke.invoke(SqlInvoke.java:227) at com.ztesoft.dataintegration.invoker.component.AbstractComponentInvoke.start(AbstractComponentInvoke.java:263) at com.ztesoft.dataintegration.invoker.component.AbstractComponentInvoke.process(AbstractComponentInvoke.java:48) at com.ztesoft.dataintegration.workflow.AgentWorkFlow$CommonNode.invoke(AgentWorkFlow.java:38) at com.ztesoft.dataintegration.workflow.AgentMachine.work(AgentMachine.java:87) ... 5 more Caused by: com.ztesoft.common.exception.SyDevOpsRuntimeException: Unknown column 'count_grp_num_m_4975_sum' in 'field list' at com.ztesoft.dataintegration.invoker.component.sql.SqlInvoke.invoke(SqlInvoke.java:209) ... 9 more Caused by: com.gbase.jdbc.exceptions.jdbc4.GBaseSyntaxErrorException: Unknown column 'count_grp_num_m_4975_sum' in 'field list' at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) at java.lang.reflect.Constructor.newInstance(Constructor.java:423) at com.gbase.jdbc.Util.handleNewInstance(Util.java:422) at com.gbase.jdbc.Util.getInstance(Util.java:397) at com.gbase.jdbc.SQLError.createSQLException(SQLError.java:1063) at com.gbase.jdbc.GBaseIO.checkErrorPacket(GBaseIO.java:3961) at com.gbase.jdbc.GBaseIO.checkErrorPacket(GBaseIO.java:3746) at com.gbase.jdbc.GBaseIO.sendCommand(GBaseIO.java:2033) at com.gbase.jdbc.GBaseIO.sqlQueryDirect(GBaseIO.java:2187) at com.gbase.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2705) at com.gbase.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2655) at com.gbase.jdbc.StatementImpl.executeInternal(StatementImpl.java:832) at com.gbase.jdbc.StatementImpl.execute(StatementImpl.java:662) at com.ztesoft.dataintegration.invoker.component.sql.SqlInvoke.invoke(SqlInvoke.java:185) ... 9 more Smart advice: